<!DOCTYPE html>
{ name:"Pittsburgh Pirates", price:7, logo:"https://a.espncdn.com/i/teamlogos/mlb/500/pit.png" },
{ name:"San Diego Padres", price:12, logo:"https://a.espncdn.com/i/teamlogos/mlb/500/sd.png" },
{ name:"San Francisco Giants", price:9, logo:"https://a.espncdn.com/i/teamlogos/mlb/500/sf.png" },
{ name:"Seattle Mariners", price:9, logo:"https://a.espncdn.com/i/teamlogos/mlb/500/sea.png" },
{ name:"St. Louis Cardinals", price:9, logo:"https://a.espncdn.com/i/teamlogos/mlb/500/stl.png" },
{ name:"Tampa Bay Rays", price:8, logo:"https://a.espncdn.com/i/teamlogos/mlb/500/tb.png" },
{ name:"Texas Rangers", price:9, logo:"https://a.espncdn.com/i/teamlogos/mlb/500/tex.png" },
{ name:"Toronto Blue Jays", price:10, logo:"https://a.espncdn.com/i/teamlogos/mlb/500/tor.png" },
{ name:"Washington Nationals", price:7, logo:"https://a.espncdn.com/i/teamlogos/mlb/500/wsh.png" },
{ name:"ðŸŽ² Spot Hors Sports", price:5, logo:"https://cdn-icons-png.flaticon.com/512/3523/3523063.png" },
{ name:"ðŸˆâš½ðŸ€ Spot Autres Sports", price:6, logo:"https://cdn-icons-png.flaticon.com/512/861/861512.png" }
];


const teamsDiv = document.getElementById("teams");
const recapDiv = document.getElementById("recap");
const timerDiv = document.getElementById("timer");


function renderTeams(taken=[]) {
teamsDiv.innerHTML="";
teams.forEach(t=>{
const d=document.createElement("div");
d.className="team"+(taken.includes(t.name)?" taken":"");
d.innerHTML=`<img src="${t.logo}"><p>${t.name}</p><p class="price">${t.price}â‚¬</p>`;
d.onclick=()=>selectTeam(t);
teamsDiv.appendChild(d);
});
}


async function selectTeam(team){
const pseudo=prompt("Pseudo :"); if(!pseudo) return;
const social=prompt("RÃ©seau social :"); if(!social) return;
if(!confirm(`Confirmer ${team.name} (${team.price}â‚¬)`)) return;
const r=await fetch(ENDPOINT,{method:"POST",body:JSON.stringify({pseudo,social,team:team.name})});
const j=await r.json();
alert(j.status==="ok"?"Inscription validÃ©e":"Erreur");
loadData();
}


async function loadData(){
const t=await (await fetch(ENDPOINT+"?mode=taken")).json();
renderTeams(t);
const r=await (await fetch(ENDPOINT+"?mode=recap")).json();
recapDiv.innerHTML="";
r.forEach(e=>{
const team=teams.find(x=>x.name===e.team);
if(team) recapDiv.innerHTML+=`<div class="recap-item"><img src="${team.logo}"><b>${e.pseudo}</b> (${team.name})</div>`;
});
}


function updateTimer(){
const diff=deadline-new Date();
if(diff<=0){timerDiv.innerHTML="â›” Inscriptions fermÃ©es";return;}
const h=Math.floor(diff/36e5),m=Math.floor(diff/6e4%60),s=Math.floor(diff/1e3%60);
timerDiv.innerHTML=`â³ Fin dans ${h}h ${m}m ${s}s`;
}


loadData(); updateTimer(); setInterval(loadData,15000); setInterval(updateTimer,1000);
</script>
</body>
</html>
